




% facts
% Computer Science (CS)
course(cs101, 'Introduction to Computer Science', [mon, wed, fri], '09:00-10:00').
course(cs102, 'Data Structures', [tue, thu], '10:30-12:00').
course(cs103, 'Computer Architecture', [mon, wed, fri], '11:00-12:00').
course(cs104, 'Algorithms', [tue, thu], '13:00-14:30').
course(cs105, 'Operating Systems', [mon, wed], '14:00-15:30').
course(cs106, 'Database Systems', [tue, thu], '15:00-16:30').
course(cs107, 'Software Engineering', [mon, wed, fri], '16:00-17:00').
course(cs108, 'Artificial Intelligence', [tue, thu], '09:00-10:30').
course(cs109, 'Machine Learning', [mon, wed], '10:00-11:30').
course(cs110, 'Computer Networks', [tue, thu], '11:30-13:00').
course(cs111, 'Compiler Design', [mon, wed, fri], '12:00-13:00').
course(cs112, 'Advanced Algorithms', [tue, thu], '13:30-15:00').
course(cs113, 'Cryptography', [mon, wed, fri], '15:30-16:30').
course(cs114, 'Parallel Computing', [tue, thu], '16:30-18:00').
course(cs115, 'Distributed Systems', [mon, wed], '09:30-11:00').
course(cs116, 'Computer Vision', [tue, thu], '10:00-11:30').
course(cs117, 'Robotics', [mon, wed, fri], '11:30-12:30').
course(cs118, 'Quantum Computing', [tue, thu], '15:30-17:00').
course(cs119, 'Cybersecurity', [mon, wed], '17:00-18:30').
course(cs120, 'Big Data Analytics', [tue, thu], '18:00-19:30').

% Mathematics (MATH)
course(math101, 'Calculus I', [mon, wed, fri], '08:00-09:00').
course(math102, 'Linear Algebra', [tue, thu], '09:30-11:00').
course(math103, 'Discrete Mathematics', [mon, wed, fri], '10:00-11:00').
course(math104, 'Probability', [tue, thu], '11:30-13:00').
course(math105, 'Statistics', [mon, wed], '13:00-14:30').
course(math106, 'Abstract Algebra', [tue, thu], '14:30-16:00').
course(math107, 'Real Analysis', [mon, wed, fri], '16:00-17:00').
course(math108, 'Complex Analysis', [tue, thu], '08:30-10:00').
course(math109, 'Numerical Methods', [mon, wed], '09:00-10:30').
course(math110, 'Topology', [tue, thu], '10:30-12:00').
course(math111, 'Optimization', [mon, wed, fri], '12:00-13:00').
course(math112, 'Graph Theory', [tue, thu], '13:30-15:00').
course(math113, 'Dynamical Systems', [mon, wed, fri], '15:30-16:30').
course(math114, 'Differential Equations', [tue, thu], '16:30-18:00').
course(math115, 'Mathematical Logic', [mon, wed], '08:00-09:30').
course(math116, 'Game Theory', [tue, thu], '09:00-10:30').
course(math117, 'Set Theory', [mon, wed, fri], '10:30-11:30').
course(math118, 'Combinatorics', [tue, thu], '15:30-17:00').
course(math119, 'Fourier Analysis', [mon, wed], '17:00-18:30').
course(math120, 'Functional Analysis', [tue, thu], '18:00-19:30').

% Physics (PHYS)
course(phys101, 'Mechanics', [mon, wed, fri], '08:30-09:30').
course(phys102, 'Electromagnetism', [tue, thu], '10:00-11:30').
course(phys103, 'Thermodynamics', [mon, wed, fri], '11:30-12:30').
course(phys104, 'Optics', [tue, thu], '13:00-14:30').
course(phys105, 'Quantum Mechanics', [mon, wed], '14:30-16:00').
course(phys106, 'Statistical Mechanics', [tue, thu], '08:00-09:30').
course(phys107, 'Astrophysics', [mon, wed, fri], '09:00-10:00').
course(phys108, 'Particle Physics', [tue, thu], '10:30-12:00').
course(phys109, 'Relativity', [mon, wed], '12:30-14:00').
course(phys110, 'Condensed Matter Physics', [tue, thu], '15:00-16:30').
course(phys111, 'Plasma Physics', [mon, wed, fri], '16:30-17:30').
course(phys112, 'Nuclear Physics', [tue, thu], '08:30-10:00').
course(phys113, 'Biophysics', [mon, wed, fri], '10:00-11:00').
course(phys114, 'Computational Physics', [tue, thu], '11:30-13:00').
course(phys115, 'Classical Mechanics', [mon, wed], '13:00-14:30').
course(phys116, 'Advanced Quantum Mechanics', [tue, thu], '14:30-16:00').
course(phys117, 'Electronics', [mon, wed, fri], '16:00-17:00').
course(phys118, 'Fluid Mechanics', [tue, thu], '17:30-19:00').
course(phys119, 'Geophysics', [mon, wed], '08:30-10:00').
course(phys120, 'Laser Physics', [tue, thu], '10:30-12:00').

% Biology (BIOL)
course(biol101, 'Introduction to Biology', [mon, wed, fri], '08:00-09:00').
course(biol102, 'Cell Biology', [tue, thu], '09:30-11:00').
course(biol103, 'Genetics', [mon, wed, fri], '10:00-11:00').
course(biol104, 'Microbiology', [tue, thu], '11:30-13:00').
course(biol105, 'Human Anatomy', [mon, wed], '13:00-14:30').
course(biol106, 'Physiology', [tue, thu], '14:30-16:00').
course(biol107, 'Neurobiology', [mon, wed, fri], '16:00-17:00').
course(biol108, 'Ecology', [tue, thu], '08:30-10:00').
course(biol109, 'Evolution', [mon, wed], '09:00-10:30').
course(biol110, 'Botany', [tue, thu], '10:30-12:00').
course(biol111, 'Zoology', [mon, wed, fri], '12:00-13:00').
course(biol112, 'Immunology', [tue, thu], '13:30-15:00').
course(biol113, 'Virology', [mon, wed, fri], '15:30-16:30').
course(biol114, 'Biochemistry', [tue, thu], '16:30-18:00').
course(biol115, 'Marine Biology', [mon, wed], '08:00-09:30').
course(biol116, 'Plant Biology', [tue, thu], '09:00-10:30').
course(biol117, 'Animal Behavior', [mon, wed, fri], '10:30-11:30').
course(biol118, 'Conservation Biology', [tue, thu], '15:30-17:00').
course(biol119, 'Environmental Science', [mon, wed], '17:00-18:30').
course(biol120, 'Molecular Biology', [tue, thu], '18:00-19:30').


% Format: final_exam(CourseName, Day, StartTime-EndTime).

:- dynamic final_exam/3.

final_exam(Course1, mon, '09:00-12:00').
final_exam(Course2, mon, '12:30-15:30').
final_exam(Course3, mon, '16:00-19:00').

final_exam(Course4, tue, '09:00-12:00').
final_exam(Course5, tue, '12:30-15:30').
final_exam(Course6, tue, '16:00-19:00').

final_exam(Course7, wed, '09:00-12:00').
final_exam(Course8, wed, '12:30-15:30').
final_exam(Course9, wed, '16:00-19:00').

final_exam(Course10, thu, '09:00-12:00').
final_exam(Course11, thu, '12:30-15:30').
final_exam(Course12, thu, '16:00-19:00').

final_exam(Course13, fri, '09:00-12:00').
final_exam(Course14, fri, '12:30-15:30').
final_exam(Course15, fri, '16:00-19:00').

final_exam(Course16, sat, '09:00-12:00').
final_exam(Course17, sat, '12:30-15:30').
final_exam(Course18, sat, '16:00-19:00').


% rules
% Parse time string 'HH:MM' into hour and minute components
parse_time(TimeString, Hour, Minute) :-
    split_string(TimeString, ":", "", [HStr, MStr]),
    number_string(Hour, HStr),
    number_string(Minute, MStr).

% Check if two time intervals overlap
time_overlap(Start1, End1, Start2, End2) :-
    parse_time(Start1, H1, M1),
    parse_time(End1, H2, M2),
    parse_time(Start2, H3, M3),
    parse_time(End2, H4, M4),
    
    % Convert times to "minutes since midnight" for easier comparison
    Start1InMinutes is H1 * 60 + M1,
    End1InMinutes is H2 * 60 + M2,
    Start2InMinutes is H3 * 60 + M3,
    End2InMinutes is H4 * 60 + M4,

    % Check if the intervals overlap
    (   Start1InMinutes < End2InMinutes,
        Start2InMinutes < End1InMinutes
    ).



% Check if two course day lists overlap
day_overlap(Days1, Days2) :-
    member(Day, Days1),       % Check each day in Days1
    member(Day, Days2).       % If it also exists in Days2, there's overlap
	

%  Check if two courses conflict based on overlapping days and times
course_conflict(Course1, Course2) :-
    course(Course1, _, Days1, TimeRange1),
    course(Course2, _, Days2, TimeRange2),
    Course1 \= Course2,    % Ensure they are different courses
    day_overlap(Days1, Days2),  % Check for day overlap
    split_string(TimeRange1, "-", "", [Start1, End1]),  % Split time range
    split_string(TimeRange2, "-", "", [Start2, End2]),  % Split time range
    time_overlap(Start1, End1, Start2, End2).    % Check if the time intervals overlap

schedule_all_exams([]).  % Base case: If the list is empty, no courses left to schedule.
schedule_all_exams([Course | RestCourses]) :-
	write(Course), nl,
    % Try to schedule Course first
    schedule_exam_for_course(Course),
    % Recursively schedule the remaining courses
    schedule_all_exams(RestCourses).
	
	% Schedule the final exam for a specific course, ensuring no conflicts.
schedule_exam_for_course(Course) :-
    % Try to find an available day and time for the course
    final_exam(Course, Day, Time),
    % If no conflict occurs, schedule the final exam for this course
    \+ exam_conflict(Course, Day, Time),  % Ensure no other course has a final at the same time
    asserta(final_exam(Course, Day, Time)).  % Schedule the course's final exam

% Check if a course's final exam conflicts with any other courses scheduled.
exam_conflict(Course, Day, Time) :-
    final_exam(OtherCourse, Day, Time),
    Course \= OtherCourse,  % Ensure it's not the same course
    \+ course_conflict(Course, OtherCourse).  % Check if the courses do not conflict (they share students).
	
% Rule to list all final exam schedules and print them out
list_all_final_exams :-
    findall(final_exam(Course, Day, Time), final_exam(Course, Day, Time), Schedule),
    print_schedule(Schedule).

% Helper rule to print the schedule
print_schedule([]).  % Base case: empty schedule, nothing to print.
print_schedule([final_exam(Course, Day, Time) | Rest]) :-
    (   var(Course) ->
        true  % Skip printing if Course is a variable
    ;   % Otherwise, print the course information
        write('Course: '), write(Course), 
        write(', Day: '), write(Day),
        write(', Time: '), write(Time), nl
    ),
    print_schedule(Rest).  % Recurse to print the rest of the schedule.

